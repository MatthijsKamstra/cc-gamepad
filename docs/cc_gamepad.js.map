{
"version":3,
"file":"cc_gamepad.js",
"sourceRoot":"file:///",
"sources":["/Users/matthijs/Documents/GIT/cc-gamepad/src/CCGamepad.hx","/Users/matthijs/Documents/GIT/cc-gamepad/src/model/constants/App.hx","/usr/local/lib/haxe/std/js/_std/Std.hx","/usr/local/lib/haxe/std/js/_std/haxe/ds/IntMap.hx","/usr/local/lib/haxe/std/haxe/iterators/ArrayIterator.hx","/usr/local/lib/haxe/std/js/Boot.hx"],
"sourcesContent":["package;\n\nimport js.html.SpanElement;\nimport haxe.Json;\nimport js.html.ProgressElement;\nimport js.html.Element;\nimport haxe.ds.StringMap;\nimport js.html.Navigator;\nimport haxe.ds.ArraySort;\nimport js.Browser.*;\nimport js.Browser.navigator;\nimport svg.*;\nimport js.Syntax;\nimport js.html.Gamepad;\nimport js.html.GamepadButton;\nimport js.html.GamepadEvent;\nimport js.html.DivElement;\n\nusing StringTools;\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API/Using_the_Gamepad_API\n// https://github.com/luser/gamepadtest/blob/master/gamepadtest.js\n// checked in firefox and Chrome.. the rest I don't use\nclass CCGamepad {\n\tvar controllers:Array<Gamepad> = []; // {};\n\tvar map:Map<Int, GamePadObject> = new Map();\n\tvar start:Dynamic;\n\tvar gamePads:Array<Gamepad>;\n\tvar gamepad:Gamepad; // 0\n\n\tvar btnNameField:DivElement;\n\n\tpublic function new() {\n\t\t// trace('START :: CCGamepad');\n\t\tdocument.addEventListener(\"DOMContentLoaded\", function(event) {\n\t\t\tconsole.log('${model.constants.App.NAME} Dom ready :: build: ${model.constants.App.getBuildDate()}');\n\t\t\tinit();\n\t\t});\n\t}\n\n\tfunction init() {\n\t\tsetupStart();\n\t\tsetupListeners();\n\t}\n\n\t// ____________________________________ setup ____________________________________\n\n\tfunction setupStart() {\n\t\tvar div = document.createDivElement();\n\t\tdiv.id = 'start-screen';\n\t\tdiv.className = \"container\";\n\t\tdiv.innerHTML = '<h2>No gamepad detected</h2><p>If you have one, make sure it\\'s plugged in / paired, and press buttons to wake it up.</p>';\n\t\tdocument.body.appendChild(div);\n\t}\n\n\tfunction setupListeners() {\n\t\twindow.addEventListener(\"gamepadconnected\", onGamepadConnectedHandler);\n\t\twindow.addEventListener(\"gamepaddisconnected\", onGamepadDisconnectedHandler);\n\t\t// might only work in Firefox\n\t\twindow.addEventListener(\"gamepadbuttondown\", onGamepadButtonDownHandler);\n\t\twindow.addEventListener(\"gamepadbuttonup\", onGamepadButtonUpHandler);\n\t\twindow.addEventListener(\"gamepadaxismove\", onGamepadAxisMoveHandler);\n\t}\n\n\tfunction setupControllerValues() {\n\t\tvar btnMap:Map<Int, String> = [];\n\t\tbtnMap.set(0, 'X');\n\t\tbtnMap.set(1, 'A');\n\t\tbtnMap.set(2, 'B');\n\t\tbtnMap.set(3, 'Y');\n\t\tbtnMap.set(4, 'Left Bottom');\n\t\tbtnMap.set(5, 'Right Bottom');\n\t\tbtnMap.set(6, '');\n\t\tbtnMap.set(7, '');\n\t\tbtnMap.set(8, 'Select');\n\t\tbtnMap.set(9, 'Start');\n\t\tvar _GamePadObject:GamePadObject = {\n\t\t\t_id: gamepad.id,\n\t\t\talias: 'fake super nintendo controller (snes)',\n\t\t\tgamepad: gamepad,\n\t\t\tbuttonMap: btnMap\n\t\t};\n\t\tmap.set(0, _GamePadObject);\n\t}\n\n\tvar btnMap:Map<Int, SpanElement> = [];\n\tvar axisMap:Map<Int, ProgressElement> = [];\n\n\tfunction setupInterface() {\n\t\tvar btnArray = gamepad.buttons;\n\t\tvar axixArray = gamepad.axes;\n\n\t\tvar d = document.createDivElement();\n\t\td.className = 'container';\n\t\td.setAttribute(\"id\", \"controller\" + gamepad.index);\n\n\t\tvar t = document.createElement(\"h1\");\n\t\tt.appendChild(document.createTextNode(\"gamepad: \" + gamepad.id));\n\t\td.appendChild(t);\n\n\t\tvar t = document.createDivElement();\n\t\tt.id = \"name-button\";\n\t\td.appendChild(t);\n\n\t\tbtnNameField = t;\n\n\t\tvar b = document.createDivElement();\n\t\tb.className = \"buttons\";\n\t\tfor (i in 0...gamepad.buttons.length) {\n\t\t\tvar e = document.createSpanElement();\n\t\t\te.className = \"button\";\n\t\t\t// e.id = \"b\" + i;\n\t\t\te.innerHTML = Std.string(i);\n\t\t\tb.appendChild(e);\n\n\t\t\tbtnMap.set(i, e);\n\t\t}\n\t\td.appendChild(b);\n\n\t\tvar a = document.createDivElement();\n\t\ta.className = \"axes\";\n\t\tfor (i in 0...gamepad.axes.length) {\n\t\t\tvar p = document.createProgressElement();\n\t\t\tp.className = \"axis\";\n\t\t\t// p.id = \"a\" + i;\n\t\t\tp.setAttribute(\"max\", \"2\");\n\t\t\tp.setAttribute(\"value\", \"1\");\n\t\t\tp.innerHTML = Std.string(i);\n\t\t\ta.appendChild(p);\n\n\t\t\taxisMap.set(i, p);\n\t\t}\n\t\td.appendChild(a);\n\n\t\tvar pre = document.createPreElement();\n\t\tpre.innerText = '- id: ${gamepad.id} \\n- connected: ${gamepad.connected}\\n- index: ${gamepad.index}';\n\t\td.appendChild(pre);\n\n\t\tvar start = document.getElementById(\"start-screen\");\n\t\tif (start != null) {\n\t\t\tstart.style.display = \"none\";\n\t\t}\n\n\t\tdocument.body.appendChild(d);\n\t}\n\n\t// ____________________________________ handlers ____________________________________\n\tfunction onGamepadConnectedHandler(e:GamepadEvent) {\n\t\t// Gamepad connected\n\t\tconsole.log(\"Gamepad connected\", e.gamepad);\n\n\t\tgamePads = navigator.getGamepads();\n\t\tconsole.log(gamePads);\n\n\t\tgamepad = navigator.getGamepads()[0];\n\t\tconsole.log(gamepad);\n\n\t\tsetupControllerValues();\n\t\tsetupInterface();\n\n\t\t// gameLoop();\n\t\ttimeoutVariable = window.setInterval(gameLoop, 500);\n\t}\n\n\tvar timeoutVariable:Int;\n\n\tfunction onGamepadDisconnectedHandler(e:GamepadEvent) {\n\t\t// Gamepad disconnected\n\t\tconsole.log(\"Gamepad disconnected\", e.gamepad);\n\t\t// removegamepad(e.gamepad);\n\t\twindow.cancelAnimationFrame(start);\n\t\twindow.clearTimeout(timeoutVariable);\n\t}\n\n\tfunction onGamepadButtonDownHandler(e) {\n\t\t// Gamepad button down\n\t\tconsole.log(\"Gamepad button down\", e.button, e.gamepad);\n\t}\n\n\tfunction onGamepadButtonUpHandler(e) {\n\t\t// Gamepad button up\n\t\tconsole.log(\"Gamepad button up\", e.button, e.gamepad);\n\t}\n\n\tfunction onGamepadAxisMoveHandler(e) {\n\t\t// Gamepad axis move\n\t\tconsole.log(\"Gamepad axis move\", e.button, e.gamepad);\n\t}\n\n\t// ____________________________________ gameLoop____________________________________\n\n\tfunction gameLoop(?value) {\n\t\ttrace('');\n\t\tfor (el in btnMap) {\n\t\t\tel.classList.remove('pressed');\n\t\t}\n\n\t\t// trace(gamepad.buttons.length);\n\n\t\tfor (i in 0...gamepad.buttons.length) {\n\t\t\tvar _button:GamepadButton = gamepad.buttons[i];\n\t\t\t// console.log(_button);\n\t\t\tif (_button.pressed) {\n\t\t\t\tvar el = btnMap.get(i);\n\t\t\t\tel.classList.add('pressed');\n\t\t\t\tvar _gamePadObject = map.get(0);\n\t\t\t\tvar temp = _gamePadObject.buttonMap.get(i);\n\t\t\t\tbtnNameField.innerText = temp;\n\t\t\t}\n\t\t}\n\n\t\t// start = window.requestAnimationFrame(gameLoop);\n\t}\n\n\t/**\n\t * var joystickX = applyDeadzone(gamepad.axes[0], 0.25);\n\t * @param number\n\t * @param threshold\n\t */\n\tfunction applyDeadzone(number:Float, threshold:Float) {\n\t\tvar percentage = (Math.abs(number) - threshold) / (1 - threshold);\n\t\tif (percentage < 0)\n\t\t\tpercentage = 0;\n\t\treturn percentage * (number > 0 ? 1 : -1);\n\t}\n\n\tstatic public function main() {\n\t\tvar app = new CCGamepad();\n\t}\n}\n\ntypedef GamePadObject = {\n\t@:optional var _id:String;\n\tvar gamepad:Gamepad;\n\tvar alias:String;\n\tvar buttonMap:Map<Int, String>;\n}\n","package model.constants;\n\nimport haxe.macro.Context;\n\nclass App {\n\tpublic static var NAME:String = \"[cc-gamepad]\";\n\n\tpublic static inline macro function getBuildDate() {\n\t\t#if !display\n\t\tvar date = Date.now().toString();\n\t\treturn macro $v{date};\n\t\t#else\n\t\tvar date = Date.now().toString();\n\t\treturn macro $v{date};\n\t\t#end\n\t}\n}\n","/*\n * Copyright (C)2005-2019 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\nimport js.Boot;\nimport js.Syntax;\n\n@:keepInit\n@:coreApi class Std {\n\tpublic static inline function is(v:Dynamic, t:Dynamic):Bool {\n\t\treturn isOfType(v, t);\n\t}\n\n\tpublic static inline function isOfType(v:Dynamic, t:Dynamic):Bool {\n\t\treturn @:privateAccess js.Boot.__instanceof(v, t);\n\t}\n\n\tpublic static inline function downcast<T:{}, S:T>(value:T, c:Class<S>):S@:privateAccess {\n\t\treturn if (js.Boot.__downcastCheck(value, c)) cast value else null;\n\t}\n\n\t@:deprecated('Std.instance() is deprecated. Use Std.downcast() instead.')\n\tpublic static inline function instance<T:{}, S:T>(value:T, c:Class<S>):S {\n\t\treturn downcast(value, c);\n\t}\n\n\t@:pure\n\tpublic static function string(s:Dynamic):String {\n\t\treturn @:privateAccess js.Boot.__string_rec(s, \"\");\n\t}\n\n\tpublic static inline function int(x:Float):Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\t@:pure\n\tpublic static function parseInt(x:String):Null<Int> {\n\t\tif(x != null) {\n\t\t\tfor(i in 0...x.length) {\n\t\t\t\tvar c = StringTools.fastCodeAt(x, i);\n\t\t\t\tif(c <= 8 || (c >= 14 && c != ' '.code && c != '-'.code)) {\n\t\t\t\t\tvar nc = StringTools.fastCodeAt(x, i + 1);\n\t\t\t\t\tvar v = js.Lib.parseInt(x, (nc == \"x\".code || nc == \"X\".code) ? 16 : 10);\n\t\t\t\t\treturn Math.isNaN(v) ? null : cast v;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static inline function parseFloat(x:String):Float {\n\t\treturn js.Syntax.code(\"parseFloat({0})\", x);\n\t}\n\n\tpublic static function random(x:Int):Int {\n\t\treturn x <= 0 ? 0 : Math.floor(Math.random() * x);\n\t}\n\n\tstatic function __init__():Void\n\t\tuntyped {\n\t\t\t__feature__(\"js.Boot.getClass\", String.prototype.__class__ = __feature__(\"Type.resolveClass\", $hxClasses[\"String\"] = String, String));\n\t\t\t__feature__(\"js.Boot.isClass\", String.__name__ = __feature__(\"Type.getClassName\", \"String\", true));\n\t\t\t__feature__(\"Type.resolveClass\", $hxClasses[\"Array\"] = Array);\n\t\t\t__feature__(\"js.Boot.isClass\", Array.__name__ = __feature__(\"Type.getClassName\", \"Array\", true));\n\t\t\t__feature__(\"Date.*\", {\n\t\t\t\t__feature__(\"js.Boot.getClass\",\n\t\t\t\t\tjs.Syntax.code('Date').prototype.__class__ = __feature__(\"Type.resolveClass\", $hxClasses[\"Date\"] = js.Syntax.code('Date'), js.Syntax.code('Date')));\n\t\t\t\t__feature__(\"js.Boot.isClass\", js.Syntax.code('Date').__name__ = \"Date\");\n\t\t\t});\n\t\t\t__feature__(\"Int.*\", js.Syntax.code('var Int = { };'));\n\t\t\t__feature__(\"Dynamic.*\", js.Syntax.code('var Dynamic = { };'));\n\t\t\t__feature__(\"Float.*\", js.Syntax.code('var Float = Number'));\n\t\t\t__feature__(\"Bool.*\", js.Syntax.code('var Bool = Boolean'));\n\t\t\t__feature__(\"Class.*\", js.Syntax.code('var Class = { };'));\n\t\t\t__feature__(\"Enum.*\", js.Syntax.code('var Enum = { };'));\n\t\t\t#if (js_es < 5)\n\t\t\t__feature__(\"Array.map\", if (Array.prototype.map == null) Array.prototype.map = function(f) {\n\t\t\t\tvar a = [];\n\t\t\t\tfor (i in 0...__this__.length)\n\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\treturn a;\n\t\t\t});\n\t\t\t__feature__(\"Array.filter\", if (Array.prototype.filter == null) Array.prototype.filter = function(f) {\n\t\t\t\tvar a = [];\n\t\t\t\tfor (i in 0...__this__.length) {\n\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\tif (f(e))\n\t\t\t\t\t\ta.push(e);\n\t\t\t\t}\n\t\t\t\treturn a;\n\t\t\t});\n\t\t\t#end\n\t\t}\n}\n","/*\n * Copyright (C)2005-2019 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.ds;\n\n@:coreApi class IntMap<T> implements haxe.Constraints.IMap<Int, T> {\n\tprivate var h:Dynamic;\n\n\tpublic inline function new():Void {\n\t\th = {};\n\t}\n\n\tpublic inline function set(key:Int, value:T):Void {\n\t\th[key] = value;\n\t}\n\n\tpublic inline function get(key:Int):Null<T> {\n\t\treturn h[key];\n\t}\n\n\tpublic inline function exists(key:Int):Bool {\n\t\treturn (cast h).hasOwnProperty(key);\n\t}\n\n\tpublic function remove(key:Int):Bool {\n\t\tif (!(cast h).hasOwnProperty(key))\n\t\t\treturn false;\n\t\tjs.Syntax.delete(h, key);\n\t\treturn true;\n\t}\n\n\tpublic function keys():Iterator<Int> {\n\t\tvar a = [];\n\t\tjs.Syntax.code(\"for( var key in {0} ) if({0}.hasOwnProperty(key)) {1}.push(key | 0)\", h, a);\n\t\treturn a.iterator();\n\t}\n\n\tpublic function iterator():Iterator<T> {\n\t\treturn untyped {\n\t\t\tref: h,\n\t\t\tit: keys(),\n\t\t\thasNext: function() {\n\t\t\t\treturn __this__.it.hasNext();\n\t\t\t},\n\t\t\tnext: function() {\n\t\t\t\tvar i = __this__.it.next();\n\t\t\t\treturn __this__.ref[i];\n\t\t\t}\n\t\t};\n\t}\n\n\t@:runtime public inline function keyValueIterator():KeyValueIterator<Int, T> {\n\t\treturn new haxe.iterators.MapKeyValueIterator(this);\n\t}\n\n\tpublic function copy():IntMap<T> {\n\t\tvar copied = new IntMap();\n\t\tfor (key in keys())\n\t\t\tcopied.set(key, get(key));\n\t\treturn copied;\n\t}\n\n\tpublic function toString():String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar it = keys();\n\t\tfor (i in it) {\n\t\t\ts.add(i);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(i)));\n\t\t\tif (it.hasNext())\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tpublic inline function clear():Void {\n\t\th = {};\n\t}\n}\n","/*\n * Copyright (C)2005-2018 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage haxe.iterators;\n\n/**\n\tThis iterator is used only when `Array<T>` is passed to `Iterable<T>`\n**/\nclass ArrayIterator<T> {\n\tfinal array:Array<T>;\n\tvar current:Int = 0;\n\n\t/**\n\t\tCreate a new `ArrayIterator`.\n\t**/\n\t#if !hl inline #end\n\tpublic function new(array:Array<T>) {\n\t\tthis.array = array;\n\t}\n\n\t/**\n\t\tSee `Iterator.hasNext`\n\t**/\n\t#if !hl inline #end\n\tpublic function hasNext() {\n\t\treturn current < array.length;\n\t}\n\n\t/**\n\t\tSee `Iterator.next`\n\t**/\n\t#if !hl inline #end\n\tpublic function next() {\n\t\treturn array[current++];\n\t}\n}\n","/*\n * Copyright (C)2005-2019 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n\npackage js;\n\nimport js.Syntax; // import it here so it's always available in the compiler\n\n@:dox(hide)\nclass Boot {\n\tstatic inline function isClass(o:Dynamic):Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isInterface(o:Class<Dynamic>):Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isInterface\", o.__isInterface__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic):Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\t@:pure static function getClass(o:Null<Dynamic>):Null<Dynamic> {\n\t\tif (o == null) {\n\t\t\treturn null;\n\t\t} else if (Std.isOfType(o, Array)) {\n\t\t\treturn Array;\n\t\t} else {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o, s:String) {\n\t\tuntyped {\n\t\t\tif (o == null)\n\t\t\t\treturn \"null\";\n\t\t\tif (s.length >= 5)\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = js.Syntax.typeof(o);\n\t\t\tif (t == \"function\" && (isClass(o) || isEnum(o)))\n\t\t\t\tt = \"object\";\n\t\t\tswitch (t) {\n\t\t\t\tcase \"object\":\n\t\t\t\t\t#if !js_enums_as_arrays\n\t\t\t\t\t__feature__(\"has_enum\", if (o.__enum__) {\n\t\t\t\t\t\tvar e = $hxEnums[o.__enum__];\n\t\t\t\t\t\tvar n = e.__constructs__[o._hx_index];\n\t\t\t\t\t\tvar con = e[n];\n\t\t\t\t\t\tif (con.__params__) {\n\t\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\t\treturn n + \"(\" + [for (p in (con.__params__ : Array<String>)) __string_rec(o[p], s)].join(\",\") + \")\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn n;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t#end\n\t\t\t\t\tif (js.Syntax.instanceof(o, Array)) {\n\t\t\t\t\t\t#if js_enums_as_arrays\n\t\t\t\t\t\t__feature__(\"has_enum\", if (o.__enum__) {\n\t\t\t\t\t\t\tif (o.length == 2)\n\t\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\t\tvar str = o[0] + \"(\";\n\t\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\t\tfor (i in 2...o.length) {\n\t\t\t\t\t\t\t\tif (i != 2)\n\t\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i], s);\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\tstr += __string_rec(o[i], s);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t\t});\n\t\t\t\t\t\t#end\n\t\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor (i in 0...o.length)\n\t\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\") + __string_rec(o[i], s);\n\t\t\t\t\t\tstr += \"]\";\n\t\t\t\t\t\treturn str;\n\t\t\t\t\t}\n\t\t\t\t\tvar tostr;\n\t\t\t\t\ttry {\n\t\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t\t} catch (e:Dynamic) {\n\t\t\t\t\t\t// strange error on IE\n\t\t\t\t\t\treturn \"???\";\n\t\t\t\t\t}\n\t\t\t\t\tif (tostr != null && tostr != js.Syntax.code(\"Object.toString\") && js.Syntax.typeof(tostr) == \"function\") {\n\t\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\t\tif (s2 != \"[object Object]\")\n\t\t\t\t\t\t\treturn s2;\n\t\t\t\t\t}\n\t\t\t\t\tvar str = \"{\\n\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t\tvar k:String = null;\n\t\t\t\t\tjs.Syntax.code(\"for( {0} in {1} ) {\", k, o);\n\t\t\t\t\tif (hasp && !o.hasOwnProperty(k))\n\t\t\t\t\t\tjs.Syntax.code(\"continue\");\n\t\t\t\t\tif (k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\")\n\t\t\t\t\t\tjs.Syntax.code(\"continue\");\n\t\t\t\t\tif (str.length != 2)\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \" + __string_rec(o[k], s);\n\t\t\t\t\tjs.Syntax.code(\"}\");\n\t\t\t\t\ts = s.substring(1);\n\t\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\t\treturn str;\n\t\t\t\tcase \"function\":\n\t\t\t\t\treturn \"<function>\";\n\t\t\t\tcase \"string\":\n\t\t\t\t\treturn o;\n\t\t\t\tdefault:\n\t\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\t@:pure private static function __interfLoop(cc:Dynamic, cl:Dynamic) {\n\t\tif (cc == null)\n\t\t\treturn false;\n\t\tif (cc == cl)\n\t\t\treturn true;\n\t\tvar intf:Dynamic = cc.__interfaces__;\n\t\tif (intf != null\n\t\t\t// ES6 classes inherit statics, so we want to avoid accessing inherited `__interfaces__`\n\t\t\t#if (js_es >= 6) && (cc.__super__ == null || cc.__super__.__interfaces__ != intf) #end\n\t\t) {\n\t\t\tfor (i in 0...intf.length) {\n\t\t\t\tvar i:Dynamic = intf[i];\n\t\t\t\tif (i == cl || __interfLoop(i, cl))\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn __interfLoop(cc.__super__, cl);\n\t}\n\n\t@:pure private static function __instanceof(o:Dynamic, cl:Dynamic) {\n\t\tif (cl == null)\n\t\t\treturn false;\n\t\tswitch (cl) {\n\t\t\tcase Int:\n\t\t\t\treturn js.Syntax.typeof(o) == \"number\" && js.Syntax.strictEq(o | 0, o);\n\t\t\tcase Float:\n\t\t\t\treturn js.Syntax.typeof(o) == \"number\";\n\t\t\tcase Bool:\n\t\t\t\treturn js.Syntax.typeof(o) == \"boolean\";\n\t\t\tcase String:\n\t\t\t\treturn js.Syntax.typeof(o) == \"string\";\n\t\t\tcase Array:\n\t\t\t\treturn js.Syntax.instanceof(o, Array) #if js_enums_as_arrays && o.__enum__ == null #end;\n\t\t\tcase Dynamic:\n\t\t\t\treturn o != null;\n\t\t\tdefault:\n\t\t\t\tif (o != null) {\n\t\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\t\tif (js.Syntax.typeof(cl) == \"function\") {\n\t\t\t\t\t\tif (__downcastCheck(o, cl))\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else if (js.Syntax.typeof(cl) == \"object\" && __isNativeObj(cl)) {\n\t\t\t\t\t\tif (js.Syntax.instanceof(o, cl))\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// do not use isClass/isEnum here\n\t\t\t\tuntyped __feature__(\"Class.*\", if (cl == Class && o.__name__ != null) return true);\n\t\t\t\tuntyped __feature__(\"Enum.*\", if (cl == Enum && o.__ename__ != null) return true);\n\t\t\t\t#if js_enums_as_arrays\n\t\t\t\treturn o.__enum__ == cl;\n\t\t\t\t#else\n\t\t\t\treturn untyped __feature__(\n\t\t\t\t\t\"has_enum\",\n\t\t\t\t\tif (o.__enum__ != null) ($hxEnums[o.__enum__]) == cl else false,\n\t\t\t\t\tfalse\n\t\t\t\t);\n\t\t\t\t#end\n\t\t}\n\t}\n\n\tstatic function __downcastCheck(o:Dynamic, cl:Class<Dynamic>):Bool {\n\t\treturn js.Syntax.instanceof(o, cl) || (isInterface(cl) && inline __implements(o, cl));\n\t}\n\n\tstatic function __implements(o:Dynamic, iface:Class<Dynamic>):Bool {\n\t\treturn __interfLoop(getClass(o), iface);\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o:Dynamic, t:Dynamic) {\n\t\tif (o == null || __instanceof(o, t))\n\t\t\treturn o;\n\t\telse\n\t\t\tthrow \"Cannot cast \" + Std.string(o) + \" to \" + Std.string(t);\n\t}\n\n\tstatic var __toStr:js.lib.Function;\n\n\tstatic function __init__() {\n\t\tBoot.__toStr = (cast {}).toString;\n\t}\n\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name:String = __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) {\n\t\treturn js.Lib.global[cast name];\n\t}\n}\n"],
"names":[],
"mappings":"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"
}